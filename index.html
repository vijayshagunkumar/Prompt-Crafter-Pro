<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptCraft Pro | AI Prompt Assistant</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/themes.css">
    
    <!-- Custom Styles -->
    <style>
        /* Inspiration Panel Fix */
        .inspiration-panel {
            max-height: 300px;
            overflow-y: auto;
            position: absolute;
            z-index: 100;
            background: var(--card-bg);
            width: 100%;
            box-shadow: var(--shadow-xl);
        }
        
        .inspiration-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            padding: 15px;
        }
        
        .inspiration-item {
            padding: 20px;
            background: var(--card-bg-alt);
            border-radius: 12px;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-height: 120px;
            justify-content: center;
        }
        
        .inspiration-item:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .inspiration-icon {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 10px;
            width: 50px;
            height: 50px;
            background: rgba(var(--primary-rgb), 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .inspiration-text {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 5px;
        }
        
        .inspiration-desc {
            font-size: 12px;
            color: var(--text-secondary);
            line-height: 1.4;
        }
        
        /* Clear Button Icon */
        .sticky-cta.reset .cta-icon {
            font-size: 16px;
        }
        
        /* Save Button Removed */
        .save-btn {
            display: none !important;
        }
        
        /* Platform Cards Improved */
        .platform-card {
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .platform-card:hover {
            transform: translateX(5px);
        }
        
        .platform-logo-container {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: white;
        }
        
        .score-bar {
            height: 4px;
            background: var(--border-color);
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }
        
        .score-fill {
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 2px;
            transition: width 0.5s ease;
        }
        
        .score-text {
            font-size: 11px;
            color: var(--text-tertiary);
            margin-top: 4px;
            display: block;
        }
        
        /* Theme-specific styles */
        .cyberpunk-theme {
            --primary: #ff00ff;
            --primary-light: #ff66ff;
            --primary-dark: #cc00cc;
            --secondary: #00ffff;
            --bg-color: #0a0a0a;
            --card-bg: #1a1a2e;
            --text-primary: #ffffff;
            --border-color: #333344;
        }
        
        .sunset-theme {
            --primary: #ff6b6b;
            --primary-light: #ff9999;
            --primary-dark: #ff3333;
            --secondary: #ffa726;
            --bg-color: #fff3e0;
            --card-bg: #ffffff;
            --text-primary: #333333;
            --border-color: #ffccbc;
        }
        
        .ocean-theme {
            --primary: #2196f3;
            --primary-light: #64b5f6;
            --primary-dark: #1976d2;
            --secondary: #00bcd4;
            --bg-color: #e3f2fd;
            --card-bg: #ffffff;
            --text-primary: #1565c0;
            --border-color: #bbdefb;
        }
        
        .forest-theme {
            --primary: #4caf50;
            --primary-light: #81c784;
            --primary-dark: #388e3c;
            --secondary: #8bc34a;
            --bg-color: #f1f8e9;
            --card-bg: #ffffff;
            --text-primary: #2e7d32;
            --border-color: #c8e6c9;
        }
        
        .midnight-theme {
            --primary: #5c6bc0;
            --primary-light: #9fa8da;
            --primary-dark: #3949ab;
            --secondary: #7986cb;
            --bg-color: #1a237e;
            --card-bg: #283593;
            --text-primary: #e8eaf6;
            --border-color: #3f51b5;
        }
        
        .rose-theme {
            --primary: #e91e63;
            --primary-light: #f48fb1;
            --primary-dark: #c2185b;
            --secondary: #ff4081;
            --bg-color: #fce4ec;
            --card-bg: #ffffff;
            --text-primary: #880e4f;
            --border-color: #f8bbd9;
        }
    </style>
</head>
<body class="dark-theme">
    <!-- Header -->
    <header class="app-header">
        <div class="container">
            <div class="header-content">
                <div class="header-top">
                    <div class="logo">
                        <div class="logo-icon">
                            <i class="fas fa-magic"></i>
                        </div>
                        <div class="logo-text">
                            <h1>PromptCraft Pro</h1>
                            <p>Transform ideas into perfect AI prompts</p>
                        </div>
                    </div>
                    
                    <div class="header-actions">
                        <button id="historyBtn" class="action-btn" title="History">
                            <i class="fas fa-history"></i>
                        </button>
                        <button id="settingsBtn" class="action-btn" title="Settings">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
                
                <div class="progress-indicator">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <div class="app-container">
            <!-- Step 1: Input -->
            <div class="card input-section">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div>
                        <h2 class="step-title">Describe Your Task</h2>
                        <p class="step-subtitle">What would you like the AI to help you with?</p>
                    </div>
                </div>
                
                <div class="textarea-container">
                    <div class="char-counter" id="charCounter">0/5000</div>
                    
                    <div class="textarea-top-right-controls">
                        <button id="maximizeInputBtn" class="action-btn" title="Maximize">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                    
                    <textarea 
                        id="userInput"
                        class="textarea"
                        placeholder="Example: Write a professional email to my team about the upcoming project deadline..."
                        rows="5"
                    ></textarea>
                    
                    <div class="textarea-controls">
                        <div class="left-controls">
                            <button id="micBtn" class="action-btn" title="Voice Input">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                        <div class="right-controls">
                            <button id="undoBtn" class="action-btn" title="Undo">
                                <i class="fas fa-undo"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Need Inspiration Button -->
                <div class="inspiration-container">
                    <button id="needInspirationBtn" class="btn btn-secondary">
                        <i class="fas fa-lightbulb"></i>
                        Need Inspiration?
                    </button>
                    
                    <div class="inspiration-panel" id="inspirationPanel">
                        <div class="inspiration-header">
                            <h4><i class="fas fa-lightbulb"></i> Inspiration Templates</h4>
                            <button id="closeInspirationBtn" class="action-btn">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <div class="inspiration-grid" id="inspirationGrid">
                            <!-- Templates loaded dynamically -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Steps 2 & 3 -->
            <div class="output-section" id="outputSection">
                <!-- Generated Prompt -->
                <div class="card">
                    <div class="step-header">
                        <div class="step-number">2</div>
                        <div>
                            <h2 class="step-title">Generated Prompt</h2>
                            <p class="step-subtitle">Optimized for AI performance</p>
                        </div>
                    </div>
                    
                    <div class="output-container">
                        <div class="output-actions">
                            <button id="speakBtn" class="action-btn" title="Listen">
                                <i class="fas fa-volume-up"></i>
                            </button>
                            <button id="copyBtn" class="action-btn" title="Copy">
                                <i class="fas fa-copy"></i>
                            </button>
                            <button id="exportBtn" class="action-btn" title="Export">
                                <i class="fas fa-download"></i>
                            </button>
                            <button id="maximizeOutputBtn" class="action-btn" title="Maximize">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                        
                        <div 
                            id="outputArea" 
                            class="output-area" 
                            contenteditable="true"
                            placeholder="Your optimized prompt will appear here..."
                        ></div>
                    </div>
                </div>

                <!-- AI Platforms -->
                <div class="platforms-sidebar">
                    <div class="card">
                        <div class="step-header">
                            <div class="step-number">3</div>
                            <div>
                                <h2 class="step-title">Deploy to AI</h2>
                                <p class="step-subtitle">Ranked by suitability</p>
                            </div>
                        </div>
                        
                        <div id="platformsGrid" class="platforms-grid">
                            <div class="empty-state" id="platformsEmptyState">
                                <i class="fas fa-robot"></i>
                                <p>Generate a prompt to see AI platforms</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- History Section -->
            <div class="history-section" id="historySection">
                <div class="card">
                    <div class="history-header">
                        <h3><i class="fas fa-history"></i> Prompt History</h3>
                        <button id="closeHistoryBtn" class="action-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="history-list" id="historyList"></div>
                </div>
            </div>
        </div>

        <!-- Sticky Buttons -->
        <div class="sticky-cta-container">
            <button id="stickyPrepareBtn" class="sticky-cta prepare">
                <i class="fas fa-magic"></i>
                <span>Prepare Prompt</span>
            </button>
        </div>
        
        <button id="stickyResetBtn" class="sticky-cta reset hidden">
            <i class="fas fa-broom"></i>
            <span>Clear All</span>
        </button>
    </main>

    <!-- Footer -->
    <footer class="app-footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <div class="footer-item">
                        <i class="fas fa-circle online"></i>
                        <span>Status: <strong>Online</strong></span>
                    </div>
                    <div class="footer-item">
                        <i class="fas fa-robot"></i>
                        <span>Model: <strong id="currentModel">Gemini</strong></span>
                    </div>
                    <div class="footer-item">
                        <i class="fas fa-palette"></i>
                        <span>Theme: <strong id="currentTheme">Dark</strong></span>
                    </div>
                </div>
                <div class="footer-copyright">
                    <p>Â© 2024 PromptCraft Pro v2.0</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Settings</h3>
                <button id="closeSettingsBtn" class="action-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <div class="settings-group">
                    <h4><i class="fas fa-palette"></i> Theme</h4>
                    <select id="themeSelect" class="form-select">
                        <option value="dark">Dark Theme</option>
                        <option value="light">Light Theme</option>
                        <option value="cyberpunk">Cyberpunk Neon</option>
                        <option value="sunset">Sunset Glow</option>
                        <option value="ocean">Ocean Deep</option>
                        <option value="forest">Forest Green</option>
                        <option value="midnight">Midnight Blue</option>
                        <option value="rose">Rose Gold</option>
                    </select>
                </div>
                
                <div class="settings-group">
                    <h4><i class="fas fa-robot"></i> AI Model</h4>
                    <select id="modelSelect" class="form-select">
                        <option value="gemini">Google Gemini</option>
                        <option value="chatgpt">ChatGPT</option>
                        <option value="claude">Claude</option>
                        <option value="perplexity">Perplexity</option>
                    </select>
                </div>
                
                <div class="settings-group">
                    <h4><i class="fas fa-language"></i> Language</h4>
                    <select id="languageSelect" class="form-select">
                        <option value="en">English</option>
                        <option value="hi">Hindi</option>
                        <option value="te">Telugu</option>
                        <option value="kn">Kannada</option>
                    </select>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="saveSettingsBtn" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Settings
                </button>
            </div>
        </div>
    </div>

    <!-- Full Screen Editor -->
    <div id="fullScreenEditor" class="full-screen-editor">
        <div class="editor-header">
            <h3 id="editorTitle">Edit Prompt</h3>
            <div class="editor-actions">
                <button id="closeEditorBtn" class="action-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>
        <textarea id="editorTextarea" class="editor-textarea"></textarea>
    </div>

    <!-- JavaScript Files -->
    <script src="js/utils/constants.js"></script>
    <script src="js/utils/helpers.js"></script>
    
    <!-- Services -->
    <script src="js/services/storage-service.js"></script>
    <script src="js/services/api-service.js"></script>
    
    <!-- Modules -->
    <script src="js/modules/intent-detector.js"></script>
    <script src="js/modules/prompt-generator.js"></script>
    <script src="js/modules/ai-ranker.js"></script>
    <script src="js/modules/voice-manager.js"></script>
    <script src="js/modules/history-manager.js"></script>
    <script src="js/modules/theme-manager.js"></script>
    
    <!-- Main App -->
    <script>
        // Main Application
        class PromptCraftApp {
            constructor() {
                this.state = {
                    hasGeneratedPrompt: false,
                    isInspirationOpen: false,
                    isHistoryOpen: false,
                    isSettingsOpen: false,
                    isEditorOpen: false
                };
                
                this.init();
            }
            
            init() {
                this.initServices();
                this.initModules();
                this.initDOM();
                this.bindEvents();
                this.setupTemplates();
                console.log('PromptCraft Pro initialized');
            }
            
            initServices() {
                this.storage = new StorageService();
                this.api = new APIService();
                this.notification = {
                    show: (msg, type) => this.showNotification(msg, type)
                };
            }
            
            initModules() {
                this.intent = new IntentDetector();
                this.prompt = new PromptGenerator();
                this.ranker = new AIRanker();
                this.voice = new VoiceManager();
                this.history = new HistoryManager();
                this.theme = new ThemeManager();
            }
            
            initDOM() {
                this.elements = {
                    userInput: document.getElementById('userInput'),
                    charCounter: document.getElementById('charCounter'),
                    micBtn: document.getElementById('micBtn'),
                    maximizeInputBtn: document.getElementById('maximizeInputBtn'),
                    needInspirationBtn: document.getElementById('needInspirationBtn'),
                    inspirationPanel: document.getElementById('inspirationPanel'),
                    closeInspirationBtn: document.getElementById('closeInspirationBtn'),
                    inspirationGrid: document.getElementById('inspirationGrid'),
                    outputSection: document.getElementById('outputSection'),
                    outputArea: document.getElementById('outputArea'),
                    copyBtn: document.getElementById('copyBtn'),
                    speakBtn: document.getElementById('speakBtn'),
                    exportBtn: document.getElementById('exportBtn'),
                    maximizeOutputBtn: document.getElementById('maximizeOutputBtn'),
                    platformsGrid: document.getElementById('platformsGrid'),
                    platformsEmptyState: document.getElementById('platformsEmptyState'),
                    stickyPrepareBtn: document.getElementById('stickyPrepareBtn'),
                    stickyResetBtn: document.getElementById('stickyResetBtn'),
                    historyBtn: document.getElementById('historyBtn'),
                    historySection: document.getElementById('historySection'),
                    historyList: document.getElementById('historyList'),
                    closeHistoryBtn: document.getElementById('closeHistoryBtn'),
                    settingsBtn: document.getElementById('settingsBtn'),
                    settingsModal: document.getElementById('settingsModal'),
                    closeSettingsBtn: document.getElementById('closeSettingsBtn'),
                    saveSettingsBtn: document.getElementById('saveSettingsBtn'),
                    themeSelect: document.getElementById('themeSelect'),
                    fullScreenEditor: document.getElementById('fullScreenEditor'),
                    closeEditorBtn: document.getElementById('closeEditorBtn'),
                    editorTextarea: document.getElementById('editorTextarea'),
                    progressFill: document.getElementById('progressFill'),
                    currentModel: document.getElementById('currentModel'),
                    currentTheme: document.getElementById('currentTheme')
                };
            }
            
            bindEvents() {
                // Input handling
                this.elements.userInput.addEventListener('input', () => this.handleInputChange());
                
                // Main buttons
                this.elements.stickyPrepareBtn.addEventListener('click', () => this.preparePrompt());
                this.elements.stickyResetBtn.addEventListener('click', () => this.resetAll());
                this.elements.copyBtn.addEventListener('click', () => this.copyPrompt());
                this.elements.exportBtn.addEventListener('click', () => this.exportPrompt());
                this.elements.speakBtn.addEventListener('click', () => this.toggleSpeech());
                
                // Voice
                this.elements.micBtn.addEventListener('click', () => this.toggleVoiceInput());
                
                // Inspiration
                this.elements.needInspirationBtn.addEventListener('click', () => this.toggleInspiration());
                this.elements.closeInspirationBtn.addEventListener('click', () => this.closeInspiration());
                
                // History
                this.elements.historyBtn.addEventListener('click', () => this.toggleHistory());
                this.elements.closeHistoryBtn.addEventListener('click', () => this.closeHistory());
                
                // Settings
                this.elements.settingsBtn.addEventListener('click', () => this.openSettings());
                this.elements.closeSettingsBtn.addEventListener('click', () => this.closeSettings());
                this.elements.saveSettingsBtn.addEventListener('click', () => this.saveSettings());
                
                // Maximize
                this.elements.maximizeInputBtn.addEventListener('click', () => this.maximizeInput());
                this.elements.maximizeOutputBtn.addEventListener('click', () => this.maximizeOutput());
                this.elements.closeEditorBtn.addEventListener('click', () => this.closeEditor());
                
                // Voice events
                document.addEventListener('voice', (e) => {
                    const { type, data } = e.detail;
                    if (type === 'listeningEnd' && data) {
                        this.elements.userInput.value = data;
                        this.handleInputChange();
                    }
                });
            }
            
            setupTemplates() {
                const templates = [
                    {
                        icon: 'fa-envelope',
                        title: 'Professional Email',
                        description: 'Write clear, professional business emails for any situation',
                        example: 'Write a professional email to the project team about the upcoming deadline extension. Include project status, new timeline, and action items.'
                    },
                    {
                        icon: 'fa-code',
                        title: 'Code Review',
                        description: 'Review and improve code quality with detailed feedback',
                        example: 'Review this Python function for calculating Fibonacci sequence. Check for performance, edge cases, and suggest improvements with code examples.'
                    },
                    {
                        icon: 'fa-chart-bar',
                        title: 'Business Report',
                        description: 'Create comprehensive business reports with data analysis',
                        example: 'Create a quarterly sales report for Q1 2024. Include sales figures by region, growth analysis, challenges faced, and recommendations for next quarter.'
                    },
                    {
                        icon: 'fa-pen',
                        title: 'Content Writing',
                        description: 'Write engaging blog posts, articles, and social media content',
                        example: 'Write a 500-word blog post about the benefits of AI in healthcare. Include real-world examples, statistics, and future predictions.'
                    },
                    {
                        icon: 'fa-graduation-cap',
                        title: 'Learning Guide',
                        description: 'Create educational content and learning materials',
                        example: 'Create a beginner-friendly tutorial for learning React.js. Include setup instructions, basic concepts, examples, and practice exercises.'
                    },
                    {
                        icon: 'fa-briefcase',
                        title: 'Project Proposal',
                        description: 'Draft professional project proposals and plans',
                        example: 'Draft a project proposal for implementing a new CRM system. Include objectives, scope, timeline, budget, and expected ROI.'
                    }
                ];
                
                const grid = this.elements.inspirationGrid;
                if (!grid) return;
                
                grid.innerHTML = '';
                templates.forEach(template => {
                    const item = document.createElement('div');
                    item.className = 'inspiration-item';
                    item.innerHTML = `
                        <div class="inspiration-icon">
                            <i class="fas ${template.icon}"></i>
                        </div>
                        <div class="inspiration-text">${template.title}</div>
                        <div class="inspiration-desc">${template.description}</div>
                    `;
                    
                    item.addEventListener('click', () => {
                        this.elements.userInput.value = template.example;
                        this.handleInputChange();
                        this.closeInspiration();
                    });
                    
                    grid.appendChild(item);
                });
            }
            
            handleInputChange() {
                const text = this.elements.userInput.value;
                const count = text.length;
                this.elements.charCounter.textContent = `${count}/5000`;
                
                // Update prepare button
                this.elements.stickyPrepareBtn.disabled = count < 10;
            }
            
            async preparePrompt() {
                const input = this.elements.userInput.value.trim();
                if (!input || input.length < 10) {
                    this.showNotification('Please enter at least 10 characters', 'error');
                    return;
                }
                
                // Show loading
                this.elements.stickyPrepareBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Preparing...';
                this.elements.stickyPrepareBtn.disabled = true;
                
                try {
                    const result = await this.api.generatePrompt(input);
                    
                    if (result.success && result.prompt) {
                        // Update output
                        this.elements.outputArea.textContent = result.prompt;
                        this.state.hasGeneratedPrompt = true;
                        
                        // Show output section
                        this.elements.outputSection.style.display = 'grid';
                        
                        // Update AI platforms
                        const intent = this.ranker.analyzeIntent(input);
                        this.ranker.renderRankedPlatforms(intent);
                        
                        // Update progress
                        this.updateProgress();
                        
                        // Auto-save to history
                        this.history.add(input, result.prompt, result.modelName);
                        
                        this.showNotification('Prompt generated successfully!', 'success');
                        
                    } else {
                        throw new Error('Failed to generate prompt');
                    }
                    
                } catch (error) {
                    console.error('Error:', error);
                    this.showNotification('Error generating prompt', 'error');
                    
                    // Fallback
                    const fallback = this.prompt.generate(input);
                    this.elements.outputArea.textContent = fallback;
                    this.state.hasGeneratedPrompt = true;
                    this.elements.outputSection.style.display = 'grid';
                    
                } finally {
                    this.elements.stickyPrepareBtn.innerHTML = '<i class="fas fa-magic"></i> Prepare Prompt';
                    this.elements.stickyPrepareBtn.disabled = false;
                    this.updateUI();
                }
            }
            
            copyPrompt() {
                const text = this.elements.outputArea.textContent;
                if (!text.trim()) {
                    this.showNotification('No prompt to copy', 'error');
                    return;
                }
                
                navigator.clipboard.writeText(text)
                    .then(() => this.showNotification('Copied to clipboard!', 'success'))
                    .catch(() => this.showNotification('Failed to copy', 'error'));
            }
            
            exportPrompt() {
                const text = this.elements.outputArea.textContent;
                if (!text.trim()) {
                    this.showNotification('No prompt to export', 'error');
                    return;
                }
                
                const blob = new Blob([text], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `prompt-${Date.now()}.txt`;
                a.click();
                URL.revokeObjectURL(url);
                this.showNotification('Prompt exported!', 'success');
            }
            
            toggleSpeech() {
                const text = this.elements.outputArea.textContent;
                if (!text.trim()) {
                    this.showNotification('No prompt to read', 'error');
                    return;
                }
                
                this.voice.speak(text);
            }
            
            toggleVoiceInput() {
                if (this.voice.isListening) {
                    this.voice.stopListening();
                    this.elements.micBtn.classList.remove('active');
                } else {
                    this.voice.startListening();
                    this.elements.micBtn.classList.add('active');
                }
            }
            
            resetAll() {
                // Clear input
                this.elements.userInput.value = '';
                
                // Clear output
                this.elements.outputArea.textContent = '';
                this.state.hasGeneratedPrompt = false;
                
                // Hide output section
                this.elements.outputSection.style.display = 'none';
                
                // Reset platforms
                if (this.elements.platformsEmptyState) {
                    this.elements.platformsGrid.innerHTML = '';
                    this.elements.platformsGrid.appendChild(this.elements.platformsEmptyState);
                }
                
                // Update UI
                this.updateUI();
                
                this.showNotification('All cleared!', 'info');
            }
            
            toggleInspiration() {
                this.state.isInspirationOpen = !this.state.isInspirationOpen;
                if (this.elements.inspirationPanel) {
                    this.elements.inspirationPanel.style.display = 
                        this.state.isInspirationOpen ? 'block' : 'none';
                }
            }
            
            closeInspiration() {
                this.state.isInspirationOpen = false;
                if (this.elements.inspirationPanel) {
                    this.elements.inspirationPanel.style.display = 'none';
                }
            }
            
            toggleHistory() {
                this.state.isHistoryOpen = !this.state.isHistoryOpen;
                if (this.elements.historySection) {
                    this.elements.historySection.style.display = 
                        this.state.isHistoryOpen ? 'block' : 'none';
                    
                    if (this.state.isHistoryOpen) {
                        this.history.renderHistoryList(this.elements.historyList);
                    }
                }
            }
            
            closeHistory() {
                this.state.isHistoryOpen = false;
                if (this.elements.historySection) {
                    this.elements.historySection.style.display = 'none';
                }
            }
            
            openSettings() {
                this.state.isSettingsOpen = true;
                if (this.elements.settingsModal) {
                    this.elements.settingsModal.style.display = 'block';
                }
            }
            
            closeSettings() {
                this.state.isSettingsOpen = false;
                if (this.elements.settingsModal) {
                    this.elements.settingsModal.style.display = 'none';
                }
            }
            
            saveSettings() {
                if (this.elements.themeSelect) {
                    const theme = this.elements.themeSelect.value;
                    this.theme.applyTheme(theme);
                }
                
                this.showNotification('Settings saved!', 'success');
                this.closeSettings();
            }
            
            maximizeInput() {
                this.state.isEditorOpen = true;
                if (this.elements.fullScreenEditor && this.elements.editorTextarea) {
                    this.elements.editorTextarea.value = this.elements.userInput.value;
                    this.elements.fullScreenEditor.style.display = 'flex';
                    this.elements.editorTitle.textContent = 'Edit Your Task';
                    this.elements.editorTextarea.focus();
                }
            }
            
            maximizeOutput() {
                this.state.isEditorOpen = true;
                if (this.elements.fullScreenEditor && this.elements.editorTextarea) {
                    this.elements.editorTextarea.value = this.elements.outputArea.textContent;
                    this.elements.fullScreenEditor.style.display = 'flex';
                    this.elements.editorTitle.textContent = 'Edit Generated Prompt';
                    this.elements.editorTextarea.focus();
                }
            }
            
            closeEditor() {
                this.state.isEditorOpen = false;
                if (this.elements.fullScreenEditor) {
                    this.elements.fullScreenEditor.style.display = 'none';
                    
                    // Save changes if any
                    if (this.elements.editorTextarea.value) {
                        if (this.elements.editorTitle.textContent.includes('Your Task')) {
                            this.elements.userInput.value = this.elements.editorTextarea.value;
                            this.handleInputChange();
                        } else {
                            this.elements.outputArea.textContent = this.elements.editorTextarea.value;
                        }
                    }
                }
            }
            
            updateProgress() {
                if (this.elements.progressFill) {
                    this.elements.progressFill.style.width = this.state.hasGeneratedPrompt ? '66%' : '33%';
                }
            }
            
            updateUI() {
                // Update button states
                const hasInput = this.elements.userInput.value.trim().length > 0;
                const hasOutput = this.state.hasGeneratedPrompt;
                
                this.elements.stickyPrepareBtn.disabled = !hasInput;
                
                if (hasOutput) {
                    this.elements.stickyPrepareBtn.style.display = 'none';
                    this.elements.stickyResetBtn.classList.remove('hidden');
                } else {
                    this.elements.stickyPrepareBtn.style.display = 'flex';
                    this.elements.stickyResetBtn.classList.add('hidden');
                }
                
                // Update footer
                if (this.elements.currentModel) {
                    this.elements.currentModel.textContent = 'Gemini';
                }
            }
            
            showNotification(message, type = 'info') {
                // Create notification element
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.innerHTML = `
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                `;
                
                // Add to body
                document.body.appendChild(notification);
                
                // Remove after 3 seconds
                setTimeout(() => {
                    notification.style.opacity = '0';
                    setTimeout(() => {
                        document.body.removeChild(notification);
                    }, 300);
                }, 3000);
            }
            
            loadFromHistory(item) {
                if (item) {
                    this.elements.userInput.value = item.input;
                    this.elements.outputArea.textContent = item.prompt;
                    this.handleInputChange();
                    this.state.hasGeneratedPrompt = true;
                    this.elements.outputSection.style.display = 'grid';
                    this.updateUI();
                    this.closeHistory();
                    this.showNotification('Loaded from history', 'success');
                }
            }
        }
        
        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            window.app = new PromptCraftApp();
        });
    </script>
</body>
</html>
