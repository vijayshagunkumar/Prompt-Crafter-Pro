<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Ultimate PromptCraft Favicon - BRAIN + SPARKLES -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90' fill='%238B5CF6'>ðŸ§ âœ¨</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90' fill='%238B5CF6'>ðŸ§ âœ¨</text></svg>">
    
    <base href="/">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8B5CF6">
    <meta name="apple-mobile-web-app-title" content="PromptCraft">
    
    <title>PromptCraft | Prompt Crafter Pro</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>
    
    <link rel="stylesheet" href="styles/variables.css">
    <link rel="stylesheet" href="styles/themes.css">
    <link rel="stylesheet" href="styles/main.css">
    
    <!-- New vertical flow styles -->
    <style>
        /* Vertical Flow Specific Styles - IMPROVED */
        .vertical-flow {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 20px;
            position: relative;
        }
        
        /* Progress indicator - IMPROVED */
        .progress-indicator {
            position: sticky;
            top: 10px;
            z-index: 100;
            margin: 20px 0 30px;
            background: rgba(var(--primary-rgb), 0.1);
            border-radius: 50px;
            padding: 6px;
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-subtle);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .progress-line {
            height: 6px;
            background: var(--gradient-brand);
            border-radius: 3px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            width: 0%;
        }
        
        /* Step cards - IMPROVED with smooth transitions */
        .step-card {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.5s ease, transform 0.5s ease;
            margin-bottom: 30px;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            pointer-events: none;
            min-height: auto;
        }
        
        .step-card.active {
            opacity: 1;
            transform: translateY(0);
            position: relative;
            pointer-events: auto;
        }
        
        /* Step indicator in cards - IMPROVED */
        .step-header .step-indicator {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .step-dots {
            display: flex;
            gap: 8px;
        }
        
        .step-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--border-subtle);
            transition: all 0.3s ease;
        }
        
        .step-dot.active {
            background: var(--primary);
            transform: scale(1.3);
            box-shadow: 0 0 10px var(--primary);
        }
        
        .step-dot.completed {
            background: var(--success);
        }
        
        /* Navigation buttons - IMPROVED */
        .card-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-subtle);
            gap: 10px;
        }
        
        .nav-btn {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            border: none;
            font-family: var(--font-sans);
            font-size: 14px;
        }
        
        .nav-btn.next {
            background: var(--gradient-brand);
            color: var(--text-on-primary);
            margin-left: auto;
            box-shadow: 0 4px 12px rgba(var(--primary-rgb), 0.3);
        }
        
        .nav-btn.prev {
            background: rgba(var(--primary-rgb), 0.1);
            color: var(--primary);
            border: 1px solid var(--border-subtle);
        }
        
        .nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }
        
        /* Status badges - IMPROVED */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: var(--font-heading);
        }
        
        .status-badge.ready {
            background: rgba(var(--success-rgb, 0, 255, 65), 0.15);
            color: var(--success);
            border: 2px solid var(--success);
            box-shadow: 0 0 10px rgba(var(--success-rgb), 0.3);
        }
        
        .status-badge.processing {
            background: rgba(var(--warning-rgb, 255, 215, 0), 0.15);
            color: var(--warning);
            border: 2px solid var(--warning);
            box-shadow: 0 0 10px rgba(var(--warning-rgb), 0.3);
        }
        
        /* Confidence badge */
        .confidence-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 6px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--success), var(--secondary));
            color: var(--text-on-primary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Expand buttons for textareas - IMPROVED */
        .expand-btn {
            position: absolute;
            top: 12px;
            right: 12px;
            z-index: 10;
            background: rgba(var(--primary-rgb), 0.1);
            border: 1px solid var(--border-subtle);
            color: var(--primary);
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .expand-btn:hover {
            background: rgba(var(--primary-rgb), 0.2);
            border-color: var(--primary);
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(var(--primary-rgb), 0.3);
        }
        
        /* Maximized textarea/output - IMPROVED */
        .maximized {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            z-index: 10000 !important;
            background: var(--bg-panel) !important;
            border: none !important;
            border-radius: 0 !important;
            padding: 80px 40px 40px !important;
            font-size: 1.1rem !important;
            resize: none !important;
            margin: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
        }
        
        /* Close maximize button - IMPROVED */
        .close-maximize-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10001;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(var(--danger-rgb, 255, 68, 68), 0.9);
            color: white;
            border: none;
            font-size: 18px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }
        
        .close-maximize-btn.active {
            display: flex;
        }
        
        .close-maximize-btn:hover {
            background: var(--danger);
            transform: scale(1.1);
        }
        
        /* Animations - IMPROVED */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideUp {
            from { 
                opacity: 0;
                transform: translateY(30px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes highlightPulse {
            0%, 100% { 
                box-shadow: 0 0 0 0 rgba(var(--primary-rgb), 0);
            }
            50% { 
                box-shadow: 0 0 25px 15px rgba(var(--primary-rgb), 0.3);
            }
        }
        
        .card-highlight {
            animation: highlightPulse 1.5s ease-in-out;
        }
        
        /* Close button for maximized view */
        .textarea-wrapper {
            position: relative;
        }
        
        /* Responsive adjustments - IMPROVED */
        @media (max-width: 768px) {
            .vertical-flow {
                padding: 0 15px;
            }
            
            .step-card {
                margin-bottom: 20px;
            }
            
            .maximized {
                padding: 60px 20px 20px !important;
            }
            
            .close-maximize-btn {
                top: 10px;
                right: 10px;
                width: 35px;
                height: 35px;
            }
            
            .card-navigation {
                flex-direction: column;
            }
            
            .nav-btn {
                width: 100%;
                justify-content: center;
            }
            
            .nav-btn.next {
                margin-left: 0;
            }
        }
        
        /* Footer fix */
        .footer {
            position: relative;
            z-index: 10;
            margin-top: 40px;
        }
        
        /* AI Ranking Explanation */
        .ai-ranking-explanation {
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            padding: 12px 16px !important;
            background: rgba(var(--primary-rgb), 0.1) !important;
            border: 1px solid var(--border-subtle) !important;
            border-radius: var(--radius-md) !important;
            margin-bottom: 20px !important;
            font-size: 14px !important;
            color: var(--text-secondary) !important;
        }
        
        .ai-ranking-explanation i {
            color: var(--primary) !important;
            font-size: 16px !important;
        }
    </style>
</head>

<body>
    <div class="scan-line"></div>
    <div id="particles" class="particles"></div>
    
    <!-- Close maximize button -->
    <button id="closeMaximizeBtn" class="close-maximize-btn" aria-label="Close maximized view" title="Close (Esc)">
        âœ•
    </button>
    
    <!-- Expand overlay -->
    <div id="expandOverlay" class="expand-overlay" style="display: none;"></div>
    
    <div id="notification" class="notification">
        <i class="fas fa-info-circle"></i>
        <span id="notificationText">Notification message</span>
    </div>

    <div class="page vertical-flow">
        <!-- HERO SECTION -->
        <header class="hero">
            <div class="hero-top">
                <div class="hero-brand">
                    <div class="hero-logo">
                        <div class="logo-circuit">
                            <div class="circuit-line circuit-horizontal"></div>
                            <div class="circuit-line circuit-vertical"></div>
                            <div class="circuit-node circuit-node-1"></div>
                            <div class="circuit-node circuit-node-2"></div>
                            <div class="circuit-node circuit-node-3"></div>
                            <div class="circuit-node circuit-node-4"></div>
                        </div>
                    </div>
                    <div class="hero-title-block">
                        <h1 class="hero-title">Master the Art of <span>Prompt Engineering</span></h1>
                        <p class="hero-subtitle">Turn rough ideas into optimized, ready-to-run prompts for AI tools.</p>
                    </div>
                </div>

                <div class="hero-actions">
                    <button class="theme-toggle-btn settings-btn" id="themeToggleBtn">
                        <i class="fas fa-palette"></i> Theme
                    </button>
                    
                    <button class="settings-btn" id="settingsBtn">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                </div>
            </div>
        </header>

        <!-- PROGRESS INDICATOR -->
        <div class="progress-indicator">
            <div id="progressLine" class="progress-line"></div>
        </div>

        <!-- MAIN WORKFLOW - VERTICAL FLOW -->
        <main class="workflow">
            <!-- CARD 1: YOUR IDEA -->
            <section id="card1" class="step-card active">
                <div class="step-header">
                    <div class="step-indicator">
                        <div class="step-dots">
                            <div class="step-dot active"></div>
                            <div class="step-dot"></div>
                            <div class="step-dot"></div>
                        </div>
                        <div>
                            <h2>STEP 1: DESCRIBE YOUR IDEA</h2>
                            <p class="step-subtitle">Tell us what you want the AI to do</p>
                        </div>
                    </div>
                    <div class="step-meta">
                        <span class="meta-pill">
                            <i class="fas fa-clock"></i>
                            <span id="timerValue">60s</span>
                        </span>
                    </div>
                </div>

                <div id="intentRow" class="intent-row" style="display:none;">
                    <div id="intentScroll" class="intent-scroll"></div>
                </div>

                <div class="chip-row">
                    <div class="chip example-btn" data-example="Write a professional email to my manager requesting leave for 3 days.">
                        <i class="fas fa-envelope"></i> Email
                    </div>
                    <div class="chip example-btn" data-example="Create a Python function to validate email addresses with regex.">
                        <i class="fas fa-code"></i> Code
                    </div>
                    <div class="chip example-btn" data-example="Analyze market trends for electric vehicles in 2024.">
                        <i class="fas fa-chart-line"></i> Analysis
                    </div>
                    <div class="chip example-btn" data-example="Write a LinkedIn post about AI productivity tools.">
                        <i class="fas fa-pen"></i> Writing
                    </div>
                </div>

                <!-- ADDED: Convert button here -->
                <div id="convertButtonContainer" style="margin: 16px 0; display: none;">
                    <button id="convertBtn" class="btn-primary btn-full">
                        <i class="fas fa-magic"></i> Convert to Prompt
                    </button>
                </div>

                <div class="auto-row">
                    <label class="toggle-switch">
                        <input type="checkbox" id="autoConvert" checked>
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">Auto-Convert</span>
                    </label>
                    <span id="autoConvertCountdown" style="display:none;">Auto-convert in 60s</span>
                </div>

                <div class="field-block">
                    <div class="textarea-wrapper">
                        <textarea id="requirement" class="textarea-idea" placeholder="Example: Write a professional email to my manager requesting leave for 3 days..."></textarea>
                        <button id="expandInputBtn" class="expand-btn" title="Maximize">
                            <i class="fas fa-expand-alt"></i>
                        </button>
                        <div class="textarea-buttons">
                            <button id="clearInputBtn" class="clear-input-btn" title="Clear text">
                                <i class="fas fa-broom"></i>
                            </button>
                            <button id="voiceInputBtn" class="voice-input-btn" title="Voice Input">
                                <i class="fas fa-microphone"></i>
                            </button>
                        </div>
                    </div>
                    <div id="voiceInputStatus" class="voice-status" style="display: none;">
                        <i class="fas fa-microphone"></i> Listening...
                    </div>
                </div>

                <div class="stats-row">
                    <span id="charCount">0 characters</span>
                    <span id="wordCount">0 words</span>
                    <span id="lineCount">1 line</span>
                </div>

                <div class="card-navigation">
                    <button id="nextToCard2" class="nav-btn next">
                        <span>Generate Prompt</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <div style="margin-top: 20px;">
                    <button id="resetBtn" class="btn-ghost-small" style="width: 100%;">
                        <i class="fas fa-redo"></i> Reset Everything
                    </button>
                </div>

                <div class="template-section" style="margin-top: 20px;">
                    <div class="template-toggle" id="toggleTemplatesBtn">
                        <div class="template-toggle-left">
                            <span class="template-toggle-eye"><i class="fas fa-eye"></i></span>
                            <span>Template Library</span>
                        </div>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    
                    <div id="templatesPanel" class="templates-panel" style="display: none;">
                        <div class="templates-header">
                            <div class="templates-header-left">
                                <div class="templates-title">Templates</div>
                                <div class="templates-sub">Save and reuse prompt patterns</div>
                            </div>
                            <div class="templates-actions-inline">
                                <button id="addTemplateBtn" class="btn-ghost-small">
                                    <i class="fas fa-plus"></i> New Template
                                </button>
                            </div>
                        </div>
                        
                        <input type="text" id="templateSearch" class="input-search" placeholder="Search templates...">
                        
                        <div id="templateCategories" class="template-categories"></div>
                        
                        <div id="templatesGrid" class="templates-grid"></div>
                        
                        <div id="emptyTemplates" class="empty-state" style="display: none;">
                            <i class="fas fa-inbox"></i>
                            <div>No templates yet. Create your first one!</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CARD 2: STRUCTURED PROMPT -->
            <section id="card2" class="step-card">
                <div class="step-header">
                    <div class="step-indicator">
                        <div class="step-dots">
                            <div class="step-dot completed"></div>
                            <div class="step-dot active"></div>
                            <div class="step-dot"></div>
                        </div>
                        <div>
                            <h2>STEP 2: STRUCTURED PROMPT</h2>
                            <p class="step-subtitle">Optimized, ready-to-run prompt</p>
                        </div>
                    </div>
                    <div class="step-meta">
                        <span class="status-badge ready" id="promptReadyBadge" style="display: none;">
                            <i class="fas fa-check"></i> Ready
                        </span>
                        <span class="meta-pill" id="convertedBadge" style="display: none;">
                            <i class="fas fa-check"></i> Converted
                        </span>
                    </div>
                </div>

                <div class="preset-selector">
                    <div class="preset-option active" data-preset="default">
                        <i class="fas fa-star"></i> Standard
                    </div>
                    <div class="preset-option" data-preset="claude">
                        <i class="fas fa-brain"></i> Claude
                    </div>
                    <div class="preset-option" data-preset="chatgpt">
                        <i class="fas fa-robot"></i> ChatGPT
                    </div>
                    <div class="preset-option" data-preset="detailed">
                        <i class="fas fa-list-check"></i> Detailed
                    </div>
                </div>

                <div class="field-block-output">
                    <div class="textarea-wrapper">
                        <textarea id="output" class="output-textarea" placeholder="Your structured prompt will appear here..." readonly></textarea>
                        <button id="expandOutputBtn" class="expand-btn" title="Maximize">
                            <i class="fas fa-expand-alt"></i>
                        </button>
                        <div class="textarea-buttons">
                            <button id="copyOutputBtn" class="btn-ghost-small" style="margin-right: 8px;">
                                <i class="fas fa-copy"></i> Copy
                            </button>
                            <button id="voiceOutputBtn" class="voice-output-btn" title="Read Aloud" style="display: none;">
                                <i class="fas fa-volume-up"></i>
                            </button>
                        </div>
                    </div>
                    <div id="voiceOutputStatus" class="voice-status" style="display: none;">
                        <i class="fas fa-volume-up"></i> Reading...
                    </div>
                </div>

                <div class="stats-row output-stats">
                    <span id="outputCharCount">0 characters</span>
                    <span id="outputWordCount">0 words</span>
                    <span id="outputLineCount">1 line</span>
                </div>

                <div class="card-navigation">
                    <button id="prevToCard1" class="nav-btn prev">
                        <i class="fas fa-arrow-left"></i>
                        <span>Back to Idea</span>
                    </button>
                    <button id="nextToCard3" class="nav-btn next">
                        <span>View AI Tools</span>
                        <i class="fas fa-arrow-right"></i>
                    </button>
                </div>

                <div class="output-footer">
                    <div class="output-actions">
                        <button id="exportBtn" class="btn-ghost-small">
                            <i class="fas fa-download"></i> Export
                        </button>
                    </div>
                    <button id="toggleHistoryBtn" class="btn-ghost-small">
                        <i class="fas fa-history"></i> History
                    </button>
                </div>

                <div id="historyPanel" class="history-panel" style="display: none;">
                    <div class="history-header">
                        <span>Recent Prompts</span>
                        <button id="clearHistoryBtn" class="btn-ghost-small danger">
                            <i class="fas fa-trash"></i> Clear
                        </button>
                    </div>
                    <div id="historyList"></div>
                </div>
            </section>

            <!-- CARD 3: LAUNCH -->
            <section id="card3" class="step-card">
                <div class="step-header">
                    <div class="step-indicator">
                        <div class="step-dots">
                            <div class="step-dot completed"></div>
                            <div class="step-dot completed"></div>
                            <div class="step-dot active"></div>
                        </div>
                        <div>
                            <h2>STEP 3: LAUNCH IN AI TOOL</h2>
                            <p class="step-subtitle">Choose your preferred AI tool</p>
                        </div>
                    </div>
                    <div class="step-meta">
                        <span class="status-badge ready">
                            <i class="fas fa-rocket"></i> Ready to Launch
                        </span>
                    </div>
                </div>
                
                <!-- AI Ranking Explanation -->
                <div id="aiRankingExplanation" class="ai-ranking-explanation" style="display: none;">
                    <i class="fas fa-lightbulb"></i>
                    <span>Tools are ranked based on your task type and requirements</span>
                </div>

                <div class="launch-list">
                    <button class="launch-btn launch-chatgpt" id="chatgptBtn" disabled>
                        <div class="launch-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <div class="launch-text">
                            <div class="launch-name">ChatGPT</div>
                            <div class="launch-sub">chat.openai.com</div>
                        </div>
                    </button>

                    <button class="launch-btn launch-claude" id="claudeBtn" disabled>
                        <div class="launch-icon">
                            <i class="fas fa-brain"></i>
                        </div>
                        <div class="launch-text">
                            <div class="launch-name">Claude</div>
                            <div class="launch-sub">claude.ai</div>
                        </div>
                    </button>

                    <button class="launch-btn launch-gemini" id="geminiBtn" disabled>
                        <div class="launch-icon">
                            <i class="fas fa-gem"></i>
                        </div>
                        <div class="launch-text">
                            <div class="launch-name">Gemini</div>
                            <div class="launch-sub">gemini.google.com</div>
                        </div>
                    </button>

                    <button class="launch-btn launch-perplexity" id="perplexityBtn" disabled>
                        <div class="launch-icon">
                            <i class="fas fa-search"></i>
                        </div>
                        <div class="launch-text">
                            <div class="launch-name">Perplexity</div>
                            <div class="launch-sub">perplexity.ai</div>
                        </div>
                    </button>

                    <button class="launch-btn launch-deepseek" id="deepseekBtn" disabled>
                        <div class="launch-icon">
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="launch-text">
                            <div class="launch-name">DeepSeek</div>
                            <div class="launch-sub">chat.deepseek.com</div>
                        </div>
                    </button>

                    <button class="launch-btn launch-copilot" id="copilotBtn" disabled>
                        <div class="launch-icon">
                            <i class="fas fa-plane"></i>
                        </div>
                        <div class="launch-text">
                            <div class="launch-name">Copilot</div>
                            <div class="launch-sub">copilot.microsoft.com</div>
                        </div>
                    </button>

                    <button class="launch-btn launch-grok" id="grokBtn" disabled>
                        <div class="launch-icon">
                            <i class="fas fa-bolt"></i>
                        </div>
                        <div class="launch-text">
                            <div class="launch-name">Grok</div>
                            <div class="launch-sub">x.ai</div>
                        </div>
                    </button>
                </div>

                <div class="card-navigation">
                    <button id="prevToCard2" class="nav-btn prev">
                        <i class="fas fa-arrow-left"></i>
                        <span>Back to Prompt</span>
                    </button>
                    <button id="restartFlow" class="nav-btn next">
                        <i class="fas fa-redo"></i>
                        <span>Start Over</span>
                    </button>
                </div>
            </section>
        </main>

        <!-- FOOTER -->
        <footer class="footer">
            <div class="footer-left">
                <span>
                    <i class="fas fa-shield-alt"></i> Cloudflare Worker â€¢ Multi-Model AI
                </span>
                <span class="dot">â€¢</span>
                <span id="currentModelDisplay">
                    <i class="fas fa-brain"></i> Model: <span id="selectedModelName">Loading...</span>
                </span>
                <span class="dot">â€¢</span>
                <span>
                    <i class="fas fa-code-branch"></i> v4.2.0
                </span>
            </div>
            <div class="footer-right">
                <div id="usageCount">
                    <i class="fas fa-bolt"></i> <span id="promptCount">0</span> prompts generated
                </div>
            </div>
        </footer>
    </div>

    <!-- MODALS -->
    <div id="settingsModal" class="modal-backdrop" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-cog"></i> Settings</h3>
                <button id="closeSettingsBtn" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="modelSelect">
                        <i class="fas fa-brain"></i> AI Model
                    </label>
                    <select id="modelSelect" class="input-text">
                        <option value="gemini-3-flash-preview">ðŸ†“ Gemini 3 Flash Preview (Latest)</option>
                        <option value="gpt-4o-mini">ðŸ†“ GPT-4o Mini</option>
                        <option value="llama-3.1-8b-instant">ðŸ†“ LLaMA 3.1 8B Instant</option>
                    </select>
                    <div class="form-hint">
                        <i class="fas fa-info-circle"></i>
                        Used when generating prompts. Free models only.
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="autoConvertDelay">
                        <i class="fas fa-clock"></i> Auto-Convert Delay
                    </label>
                    <input type="range" id="autoConvertDelay" min="5" max="120" value="60" class="input-text">
                    <div class="form-hint">
                        <i class="fas fa-sliders-h"></i>
                        <span id="delayValue">Current: 60 seconds</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="voiceLanguage">
                        <i class="fas fa-language"></i> Voice Language
                    </label>
                    <select id="voiceLanguage" class="input-text">
                        <option value="en-US">English (US)</option>
                        <option value="en-GB">English (UK)</option>
                        <option value="hi-IN">Hindi (India)</option>
                        <option value="es-ES">Spanish</option>
                        <option value="fr-FR">French</option>
                        <option value="de-DE">German</option>
                        <option value="ja-JP">Japanese</option>
                    </select>
                    <div class="form-hint">
                        <i class="fas fa-microphone"></i>
                        For voice input and output
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-expand-alt"></i> Textarea Sizing
                    </label>
                    <button id="resetSizesBtn" class="btn-ghost-small">
                        <i class="fas fa-undo"></i> Reset to Default (250px)
                    </button>
                    <div class="form-hint">
                        <i class="fas fa-arrows-alt-v"></i>
                        Drag textarea edges to resize. Click expand button for full-screen.
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button id="clearDataBtn" class="btn-ghost-small danger">
                        <i class="fas fa-trash"></i> Clear All Data
                    </button>
                    <button id="saveSettingsBtn" class="btn-primary">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="templateModal" class="modal-backdrop" style="display: none;">
        <div class="modal">
            <div class="modal-header">
                <h3><i class="fas fa-save"></i> Save Template</h3>
                <button id="closeTemplateBtn" class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="templateName">
                        <i class="fas fa-heading"></i> Template Name
                    </label>
                    <input type="text" id="templateName" class="input-text" placeholder="Professional Email Template">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="templateDescription">
                        <i class="fas fa-align-left"></i> Description
                    </label>
                    <input type="text" id="templateDescription" class="input-text" placeholder="Write professional business emails">
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="templateCategory">
                        <i class="fas fa-folder"></i> Category
                    </label>
                    <select id="templateCategory" class="input-text">
                        <option value="communication">Communication</option>
                        <option value="coding">Coding</option>
                        <option value="writing">Writing</option>
                        <option value="analysis">Analysis</option>
                        <option value="business">Business</option>
                        <option value="creative">Creative</option>
                        <option value="education">Education</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="templateContent">
                        <i class="fas fa-code"></i> Template Content
                    </label>
                    <textarea id="templateContent" class="input-text" rows="6" placeholder="Template content..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="templateExample">
                        <i class="fas fa-lightbulb"></i> Example Requirement
                    </label>
                    <textarea id="templateExample" class="input-text" rows="3" placeholder="Example requirement that triggers this template..."></textarea>
                </div>
                
                <div class="modal-actions">
                    <button id="cancelTemplateBtn" class="btn-ghost-small">
                        Cancel
                    </button>
                    <button id="saveTemplateBtn" class="btn-primary">
                        <i class="fas fa-save"></i> Save Template
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="themeModal" class="modal-backdrop" style="display: none;">
        <div class="modal" style="max-width: 550px;">
            <div class="modal-header">
                <h3><i class="fas fa-palette"></i> Select Theme</h3>
                <button class="modal-close" id="closeThemeBtn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="theme-modal-content">
                    <div class="theme-current-display">
                        <div class="current-theme-label">Current Theme:</div>
                        <div id="currentThemeName" class="current-theme-name">Simple</div>
                        <div id="currentThemeMood" class="current-theme-mood">Clean & Minimal</div>
                    </div>
                    
                    <div class="theme-grid" id="themeGrid">
                        <!-- Theme cards will be populated by JavaScript -->
                    </div>
                    
                    <div class="theme-hint">
                        <i class="fas fa-info-circle"></i>
                        Click any theme to apply. Changes take effect immediately.
                    </div>
                    
                    <div class="modal-actions">
                        <button id="closeThemeModalBtn" class="btn-ghost">
                            <i class="fas fa-times"></i> Close
                        </button>
                        <button id="resetThemeBtn" class="btn-primary">
                            <i class="fas fa-redo"></i> Reset to Simple
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="js/theme-manager.js"></script>
    <script src="js/voice.js"></script>
    <script src="js/intent.js"></script>
    <script src="js/ai-tool-ranker.js"></script>
    <script src="js/app.js"></script> 
    
    
    <!-- New Vertical Flow JavaScript -->
    <script>
    // Vertical Flow Navigation System - IMPROVED
    document.addEventListener('DOMContentLoaded', function() {
        // State management
        let currentCard = 1;
        const totalCards = 3;
        let isAnimating = false;
        
        // Initialize cards
        initializeCards();
        
        // Setup navigation
        setupNavigation();
        
        // Setup maximize/minimize
        setupMaximizeFeatures();
        
        // Update progress on load
        updateProgress();
        
        // Setup keyboard shortcuts
        setupKeyboardShortcuts();
        
        // Initialize AI ranking explanation
        initializeAIRankingExplanation();
        
        // Initialize on load
        setTimeout(() => {
            updateNavigationButtons();
            updateConvertButtonVisibility();
        }, 100);
        
        function initializeCards() {
            // Hide all cards except first
            document.querySelectorAll('.step-card').forEach((card, index) => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                card.style.pointerEvents = 'none';
                card.style.position = 'absolute';
                
                if (index === 0) {
                    setTimeout(() => {
                        card.classList.add('active');
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                        card.style.position = 'relative';
                        card.style.pointerEvents = 'auto';
                    }, 100);
                } else {
                    card.classList.remove('active');
                }
            });
            
            // Update step dots
            updateStepDots();
        }
        
        function updateStepDots() {
            document.querySelectorAll('.step-dot').forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                
                if (index + 1 === currentCard) {
                    dot.classList.add('active');
                } else if (index + 1 < currentCard) {
                    dot.classList.add('completed');
                }
            });
        }
        
        function updateProgress() {
            const progressLine = document.getElementById('progressLine');
            if (progressLine) {
                const progressPercent = ((currentCard - 1) / (totalCards - 1)) * 100;
                progressLine.style.width = `${progressPercent}%`;
            }
        }
        
        function navigateToCard(cardNumber) {
            if (cardNumber < 1 || cardNumber > totalCards) return;
            if (isAnimating) return;
            
            isAnimating = true;
            
            // Animate out current card
            const current = document.querySelector('.step-card.active');
            if (current) {
                current.style.opacity = '0';
                current.style.transform = 'translateY(30px)';
                current.style.pointerEvents = 'none';
                
                setTimeout(() => {
                    current.classList.remove('active');
                    current.style.position = 'absolute';
                    
                    // Show new card
                    const nextCard = document.getElementById(`card${cardNumber}`);
                    if (nextCard) {
                        nextCard.style.position = 'relative';
                        nextCard.classList.add('active');
                        
                        setTimeout(() => {
                            nextCard.style.opacity = '1';
                            nextCard.style.transform = 'translateY(0)';
                            nextCard.style.pointerEvents = 'auto';
                            
                            // Scroll to top of card
                            window.scrollTo({
                                top: nextCard.offsetTop - 100,
                                behavior: 'smooth'
                            });
                            
                            // Highlight card
                            nextCard.classList.add('card-highlight');
                            setTimeout(() => {
                                nextCard.classList.remove('card-highlight');
                            }, 1500);
                            
                            currentCard = cardNumber;
                            updateStepDots();
                            updateProgress();
                            
                            // Enable/disable navigation buttons
                            updateNavigationButtons();
                            
                            isAnimating = false;
                            
                        }, 50);
                    }
                    
                }, 300);
            }
        }
        
        function setupNavigation() {
            // Next to Card 2 (Generate Prompt)
            document.getElementById('nextToCard2').addEventListener('click', function() {
                const requirement = document.getElementById('requirement').value.trim();
                if (!requirement) {
                    showNotification('Please describe your idea first');
                    return;
                }
                
                // Generate prompt if not already generated
                if (typeof generatePrompt === 'function') {
                    generatePrompt();
                }
                
                // Show prompt ready badge
                document.getElementById('promptReadyBadge').style.display = 'inline-flex';
                
                navigateToCard(2);
            });
            
            // Next to Card 3 (View AI Tools)
            document.getElementById('nextToCard3').addEventListener('click', function() {
                const output = document.getElementById('output').value.trim();
                if (!output) {
                    showNotification('Please generate a prompt first');
                    return;
                }
                
                navigateToCard(3);
            });
            
            // Previous navigation
            document.getElementById('prevToCard1').addEventListener('click', function() {
                navigateToCard(1);
            });
            
            document.getElementById('prevToCard2').addEventListener('click', function() {
                navigateToCard(2);
            });
            
            // Restart flow
            document.getElementById('restartFlow').addEventListener('click', function() {
                if (typeof resetEverything === 'function') {
                    resetEverything();
                }
                navigateToCard(1);
            });
            
            // Update button states initially
            updateNavigationButtons();
        }
        
        function updateNavigationButtons() {
            // Card 1 next button
            const requirement = document.getElementById('requirement').value.trim();
            const nextToCard2 = document.getElementById('nextToCard2');
            if (nextToCard2) {
                nextToCard2.disabled = !requirement;
            }
            
            // Card 2 next button
            const output = document.getElementById('output').value.trim();
            const nextToCard3 = document.getElementById('nextToCard3');
            if (nextToCard3) {
                nextToCard3.disabled = !output;
            }
        }
        
        // Listen for input changes to update button states
        document.getElementById('requirement').addEventListener('input', function() {
            updateNavigationButtons();
            updateConvertButtonVisibility();
        });
        
        document.getElementById('output').addEventListener('input', updateNavigationButtons);
        
        function setupMaximizeFeatures() {
            const expandInputBtn = document.getElementById('expandInputBtn');
            const expandOutputBtn = document.getElementById('expandOutputBtn');
            const closeMaximizeBtn = document.getElementById('closeMaximizeBtn');
            const expandOverlay = document.getElementById('expandOverlay');
            
            let isMaximized = false;
            let currentMaximizedElement = null;
            
            // Input textarea maximize
            expandInputBtn.addEventListener('click', function() {
                const textarea = document.getElementById('requirement');
                if (!isMaximized) {
                    textarea.classList.add('maximized');
                    closeMaximizeBtn.classList.add('active');
                    expandOverlay.style.display = 'block';
                    isMaximized = true;
                    currentMaximizedElement = textarea;
                    textarea.focus();
                }
            });
            
            // Output textarea maximize
            expandOutputBtn.addEventListener('click', function() {
                const textarea = document.getElementById('output');
                if (!isMaximized) {
                    textarea.classList.add('maximized');
                    closeMaximizeBtn.classList.add('active');
                    expandOverlay.style.display = 'block';
                    isMaximized = true;
                    currentMaximizedElement = textarea;
                }
            });
            
            // Close maximize
            closeMaximizeBtn.addEventListener('click', closeMaximized);
            expandOverlay.addEventListener('click', closeMaximized);
            
            function closeMaximized() {
                if (isMaximized && currentMaximizedElement) {
                    currentMaximizedElement.classList.remove('maximized');
                    closeMaximizeBtn.classList.remove('active');
                    expandOverlay.style.display = 'none';
                    isMaximized = false;
                    currentMaximizedElement = null;
                }
            }
            
            // Escape key to close maximize
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && isMaximized) {
                    closeMaximized();
                }
            });
        }
        
        function setupKeyboardShortcuts() {
            document.addEventListener('keydown', function(e) {
                // Ctrl/Cmd + Enter to go to next card
                if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                    e.preventDefault();
                    
                    if (currentCard === 1) {
                        document.getElementById('nextToCard2').click();
                    } else if (currentCard === 2) {
                        document.getElementById('nextToCard3').click();
                    }
                }
                
                // Arrow keys for navigation
                if (e.key === 'ArrowRight' && currentCard < totalCards) {
                    e.preventDefault();
                    navigateToCard(currentCard + 1);
                }
                
                if (e.key === 'ArrowLeft' && currentCard > 1) {
                    e.preventDefault();
                    navigateToCard(currentCard - 1);
                }
            });
        }
        
        function initializeAIRankingExplanation() {
            const aiRankingExplanation = document.getElementById('aiRankingExplanation');
            if (aiRankingExplanation) {
                // Show explanation when card 3 becomes active
                const observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                            if (mutation.target.classList.contains('active') && mutation.target.id === 'card3') {
                                setTimeout(() => {
                                    aiRankingExplanation.style.display = 'flex';
                                }, 300);
                            } else if (mutation.target.id === 'card3') {
                                aiRankingExplanation.style.display = 'none';
                            }
                        }
                    });
                });
                
                observer.observe(document.getElementById('card3'), {
                    attributes: true
                });
            }
        }
        
        // Convert Button Visibility Management
        function updateConvertButtonVisibility() {
            const requirement = document.getElementById('requirement').value.trim();
            const convertBtnContainer = document.getElementById('convertButtonContainer');
            const convertBtn = document.getElementById('convertBtn');
            
            if (requirement) {
                if (convertBtnContainer) convertBtnContainer.style.display = 'block';
                if (convertBtn) convertBtn.disabled = false;
            } else {
                if (convertBtnContainer) convertBtnContainer.style.display = 'none';
                if (convertBtn) convertBtn.disabled = true;
            }
        }
        
        // Add input event listener for requirement
        const requirementInput = document.getElementById('requirement');
        if (requirementInput) {
            requirementInput.addEventListener('input', function() {
                updateConvertButtonVisibility();
                updateNavigationButtons();
            });
        }
        
        // Initialize on load
        updateConvertButtonVisibility();
    });
    
    // Theme Manager Script
    document.addEventListener('DOMContentLoaded', function() {
        // Initialize theme
        const savedTheme = localStorage.getItem('selectedTheme') || 'cyberpunk-neon';
        document.documentElement.setAttribute('data-theme', savedTheme);
        
        // Hide scan line for simple theme
        if (savedTheme === 'simple') {
            document.querySelector('.scan-line').style.display = 'none';
        }
        
        // Update theme button
        const themeBtn = document.getElementById('themeToggleBtn');
        if (themeBtn) {
            const themeNames = {
                'simple': 'Simple',
                'cyberpunk-neon': 'Cyberpunk Neon',
                'sunset-glow': 'Sunset Glow',
                'aurora-magic': 'Aurora Magic',
                'serenity-bliss': 'Serenity Bliss',
                'ocean-deep': 'Ocean Deep',
                'matrix': 'The Matrix',
                'cybernoir': 'Cyber Noir',
                'neon-dream': 'Neon Dream',
                'vaporwave': 'Vaporwave',
                'toxic-green': 'Toxic Green',
                'solar-flare': 'Solar Flare',
                'deep-space': 'Deep Space',
                'monochrome': 'Monochrome',
                'auto': 'Auto (System)'
            };
            themeBtn.innerHTML = `<i class="fas fa-palette"></i> ${themeNames[savedTheme] || 'Theme'}`;
        }
        
        // Theme modal functionality
        const themeModal = document.getElementById('themeModal');
        const themeToggleBtn = document.getElementById('themeToggleBtn');
        const closeThemeBtn = document.getElementById('closeThemeBtn');
        const closeThemeModalBtn = document.getElementById('closeThemeModalBtn');
        const resetThemeBtn = document.getElementById('resetThemeBtn');
        
        // Open theme modal
        if (themeToggleBtn) {
            themeToggleBtn.addEventListener('click', function() {
                if (themeModal) {
                    themeModal.style.display = 'flex';
                    updateCurrentThemeDisplay();
                    updateActiveThemeCard();
                }
            });
        }
        
        // Close theme modal
        if (closeThemeBtn) {
            closeThemeBtn.addEventListener('click', closeThemeModal);
        }
        
        if (closeThemeModalBtn) {
            closeThemeModalBtn.addEventListener('click', closeThemeModal);
        }
        
        // Close on backdrop click
        if (themeModal) {
            themeModal.addEventListener('click', function(e) {
                if (e.target === themeModal) {
                    closeThemeModal();
                }
            });
        }
        
        // Escape key to close
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && themeModal && themeModal.style.display === 'flex') {
                closeThemeModal();
            }
        });
        
        // Theme card click handlers
        const themeCards = document.querySelectorAll('.theme-card');
        themeCards.forEach(card => {
            card.addEventListener('click', function() {
                const themeId = this.getAttribute('data-theme');
                if (themeId) {
                    setTheme(themeId);
                }
            });
        });
        
        // Reset theme to Simple
        if (resetThemeBtn) {
            resetThemeBtn.addEventListener('click', function() {
                setTheme('simple');
            });
        }
        
        // Functions
        function closeThemeModal() {
            if (themeModal) {
                themeModal.style.display = 'none';
            }
        }
        
        function setTheme(themeId) {
            // Set theme attribute
            document.documentElement.setAttribute('data-theme', themeId);
            
            // Save to localStorage
            localStorage.setItem('selectedTheme', themeId);
            
            // Show/hide scan line
            const scanLine = document.querySelector('.scan-line');
            if (themeId === 'simple') {
                scanLine.style.display = 'none';
            } else {
                scanLine.style.display = 'block';
            }
            
            // Update theme button
            const themeNames = {
                'simple': 'Simple',
                'cyberpunk-neon': 'Cyberpunk Neon',
                'sunset-glow': 'Sunset Glow',
                'aurora-magic': 'Aurora Magic',
                'serenity-bliss': 'Serenity Bliss',
                'ocean-deep': 'Ocean Deep',
                'matrix': 'The Matrix',
                'cybernoir': 'Cyber Noir',
                'neon-dream': 'Neon Dream',
                'vaporwave': 'Vaporwave',
                'toxic-green': 'Toxic Green',
                'solar-flare': 'Solar Flare',
                'deep-space': 'Deep Space',
                'monochrome': 'Monochrome',
                'auto': 'Auto (System)'
            };
            
            if (themeBtn) {
                themeBtn.innerHTML = `<i class="fas fa-palette"></i> ${themeNames[themeId] || 'Theme'}`;
            }
            
            // Update current theme display
            updateCurrentThemeDisplay();
            
            // Update active theme card
            updateActiveThemeCard();
            
            // Show notification using the global function
            if (typeof showNotification === 'function') {
                showNotification(`Theme changed to "${themeNames[themeId] || themeId}"`);
            }
            
            // Close modal after selection
            setTimeout(() => {
                closeThemeModal();
            }, 500);
        }
        
        function updateCurrentThemeDisplay() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const themeNames = {
                'simple': 'Simple',
                'cyberpunk-neon': 'Cyberpunk Neon',
                'sunset-glow': 'Sunset Glow',
                'aurora-magic': 'Aurora Magic',
                'serenity-bliss': 'Serenity Bliss',
                'ocean-deep': 'Ocean Deep',
                'matrix': 'The Matrix',
                'cybernoir': 'Cyber Noir',
                'neon-dream': 'Neon Dream',
                'vaporwave': 'Vaporwave',
                'toxic-green': 'Toxic Green',
                'solar-flare': 'Solar Flare',
                'deep-space': 'Deep Space',
                'monochrome': 'Monochrome',
                'auto': 'Auto (System)'
            };
            
            const themeMoods = {
                'simple': 'Clean & Minimal',
                'cyberpunk-neon': 'Energetic & Futuristic',
                'sunset-glow': 'Warm & Inviting',
                'aurora-magic': 'Magical & Dreamy',
                'serenity-bliss': 'Calm & Peaceful',
                'ocean-deep': 'Professional & Deep',
                'matrix': 'Green Digital Rain',
                'cybernoir': 'Black/White/Red Noir',
                'neon-dream': 'Magenta & Cyan Neon',
                'vaporwave': 'Pink/Cyan Aesthetic',
                'toxic-green': 'Neon Toxic Green',
                'solar-flare': 'Orange & Gold Solar',
                'deep-space': 'Cosmic Purple & Blue',
                'monochrome': 'Black & White Minimal',
                'auto': 'Follows System Preference'
            };
            
            const currentThemeName = document.getElementById('currentThemeName');
            const currentThemeMood = document.getElementById('currentThemeMood');
            
            if (currentThemeName) {
                currentThemeName.textContent = themeNames[currentTheme] || currentTheme;
            }
            if (currentThemeMood) {
                currentThemeMood.textContent = themeMoods[currentTheme] || '';
            }
        }
        
        function updateActiveThemeCard() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const themeCards = document.querySelectorAll('.theme-card');
            
            themeCards.forEach(card => {
                card.classList.remove('active');
                
                // Remove existing active badges
                const badges = card.querySelectorAll('.theme-card-badge.active-badge');
                badges.forEach(badge => badge.remove());
                
                // Add active class and badge to current theme
                if (card.getAttribute('data-theme') === currentTheme) {
                    card.classList.add('active');
                    card.insertAdjacentHTML('beforeend', 
                        '<div class="theme-card-badge active-badge"><i class="fas fa-check"></i> Active</div>'
                    );
                }
            });
        }
        
        // Initialize display
        updateCurrentThemeDisplay();
        updateActiveThemeCard();
    });
    
    // AI Model Selector Script
    document.addEventListener('DOMContentLoaded', function() {
        const modelSelect = document.getElementById('modelSelect');
        const selectedModelName = document.getElementById('selectedModelName');
        
        if (modelSelect && selectedModelName) {
            const MODEL_DISPLAY_NAMES = {
                'gemini-1.5-flash-latest': 'Gemini 1.5 Flash',
                'gemini-1.5-flash': 'Gemini 1.5 Flash',
                'gpt-4o-mini': 'GPT-4o Mini',
                'llama-3.1-8b-instant': 'LLaMA 3.1 8B'
            };
            
            const DEFAULT_MODEL = 'gemini-1.5-flash-latest';
            const STORAGE_KEY = 'promptcrafter_model';
            
            const savedModel = localStorage.getItem(STORAGE_KEY);
            let currentModel = savedModel || DEFAULT_MODEL;
            
            modelSelect.value = currentModel;
            updateFooterModelDisplay(currentModel);
            
            modelSelect.addEventListener('change', function() {
                const selectedModel = this.value;
                localStorage.setItem(STORAGE_KEY, selectedModel);
                currentModel = selectedModel;
                
                updateFooterModelDisplay(selectedModel);
                
                const optionText = this.options[this.selectedIndex].text;
                if (typeof showNotification === 'function') {
                    showNotification(`AI Model set to: ${optionText}`);
                }
                
                const geminiBtn = document.getElementById('geminiBtn');
                if (geminiBtn) {
                    if (selectedModel === 'gemini-1.5-flash-latest') {
                        geminiBtn.style.opacity = '1';
                        geminiBtn.style.cursor = 'pointer';
                    } else {
                        geminiBtn.style.opacity = '0.6';
                        geminiBtn.style.cursor = 'not-allowed';
                    }
                }
            });
            
            const geminiBtn = document.getElementById('geminiBtn');
            if (geminiBtn) {
                if (currentModel === 'gemini-1.5-flash-latest') {
                    geminiBtn.style.opacity = '1';
                    geminiBtn.style.cursor = 'pointer';
                } else {
                    geminiBtn.style.opacity = '0.6';
                    geminiBtn.style.cursor = 'not-allowed';
                }
            }
            
            function updateFooterModelDisplay(modelValue) {
                if (!selectedModelName) return;
                
                const displayName = MODEL_DISPLAY_NAMES[modelValue] || modelValue;
                selectedModelName.textContent = displayName;
                
                selectedModelName.className = '';
                
                if (modelValue.includes('gemini')) {
                    selectedModelName.classList.add('model-gemini');
                } else if (modelValue.includes('gpt')) {
                    selectedModelName.classList.add('model-gpt');
                } else if (modelValue.includes('llama')) {
                    selectedModelName.classList.add('model-llama');
                }
            }
        }
    });
    </script>

</body>
</html>
